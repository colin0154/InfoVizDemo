**Sorry For the Chinese, I'm not in the mood writing English.**

## 这个文件夹是做什么的？

从NCD.RisC里下载的数据集是以csv格式保存的，而且数据结构也不符合我程序的设计，所以需要先进行转化。

大概思路是这样的：首先是在[CSVJSON](https://www.csvjson.com/csv2json)网站把csv转换成json（非常感谢这个网站，节省了很多功夫），随后我写了一个简单的Node.js脚本，按照下面的方式重新导出一份json。

原数据我猜有小数点后十位？新的数据把患病率转换成了百分比，然后只保留小数点后一位，因为最后前端也只呈现后一位。

用C#的话来说，这整个过程很像Serialization？把Object保存出来，下次直接读取就能用了。

## 人均GDP与国家代码（新增）

我忘了还有人均GDP的数据要做，之后导出来两份json，一份是按 `{ 国家代码: [人均GDP] }`的，另一份就单纯只是`{ 国家代码: "中文名"}`。

大概操作跟患病率是一样的，只是在网上转换的时生成的旧数据结构不一样，一个是Array，另一个是Hash（我直接当作Object来看）。这样我才能在Array中for each的时候，直接读取另一个数据集中对应的数据。

本以为会跑很久的，花了一小时写的脚本，结果按下回车的一瞬间就处理完了。不得不佩服JavaScript的处理速度（以及不用编译）。就只是脚本写起来头疼，loose your type, lose my mind.

## 患病率数据结构

### 旧的结构

~~~JSON
[
  {
    "ISO": "CHN",
    "Year": 1975,
    "Mean": 20.89856909,
    "Underweight": 0.112533087,
    "Obesity": 0.00243314,
    "Severe": 0.000023,
    "Morbid": 0.00000349
  },
  {
    "ISO": "CHN",
    "Year": 1976,
    "Mean": 20.95391576,
    "Underweight": 0.111109734,
    "Obesity": 0.002592483,
    "Severe": 0.0000245,
    "Morbid": 0.0000034
  },
  ...
]
~~~

这个结构的问题在于，每一个国家的每一个年份都会是单独的Object，这很明显就不合理。

（不合理是因为，我不可能每次查询数据都来一个foreach，然后还得判断国家名和年份，这谁顶得住啊）

### 新的结构

```JSON
{
  "CHN":{
    "Mean":[20.9,21,21,21.1,21.1,21.2,21.3,21.3,21.4,21.5,21.5,21.6,21.7,21.7,21.8,21.9,21.9,22,22,22.1,22.2,22.2,22.3,22.4,22.4,22.5,22.6,22.6,22.7,22.8,22.9,23,23.1,23.2,23.3,23.4,23.6,23.7,23.8,24,24.1,24.3],
    "Underweight":[11.3,11.1,11,10.8,10.7,10.5,10.4,10.2,10.1,9.9,9.8,9.6,9.5,9.3,9.1,9,8.8,8.7,8.5,8.3,8.1,8,7.8,7.6,7.4,7.2,7,6.7,6.5,6.3,6.1,5.9,5.6,5.4,5.2,5,4.8,4.6,4.4,4.2,4,3.8],
    "Obesity":[0.2,0.3,0.3,0.3,0.3,0.3,0.4,0.4,0.4,0.5,0.5,0.6,0.6,0.7,0.7,0.8,0.9,1,1,1.1,1.2,1.3,1.5,1.6,1.7,1.9,2,2.2,2.4,2.5,2.8,3,3.2,3.5,3.7,4,4.3,4.6,5,5.3,5.7,6.1],
    "Severe":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.2,0.2,0.2,0.3,0.3,0.4,0.4,0.5,0.5,0.6],
    "Morbid":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1,0.1,0.1,0.2]
  }
}
```
在新的结构里，以国家为单位，每一个国家只有一对key-value pair，里面的五个properties分别代表着我们五类数据的Array。Array是以年份为单位的，第一年是1975年。

假如要查询2008年的BMI中值数据，就只需要`CHN.Mean[2008-1975]`即可。（希望我语法没打错）简直不能更方便了。



